relocation R_X86_64_32S against `.data' can not be used when making a PIE object; recompile with -fPIE

section .data
    pi dq 3.14
    degree_to_rad dq 0.017 ; pi / 180
    alpha dq 0
    value dq 0

section .text
    global getsin

getsin:
    ; Load alpha (angle in degrees) into st(0)
    fld qword [alpha]

    ; Convert degrees to radians
    ; Multiply st(0) by degree_to_rad (pi / 180)
    fld qword [degree_to_rad]
    fmul

    ; Calculate sine of st(0) and store result in st(0)
    fsin

    ; Store the result in value
    fstp qword [value]

    ; Return to caller
    ret

#include <stdio.h>

extern double alpha, value;
void getsin();

int main(int ac, char *av[])
{
    int i;
    for (i = 0; i < 361; i++)
    {
        alpha = i;
        getsin();
        printf("%4d %13.7f\n", i, value);
    }
    return 0;
}

Компилируйте программу на C:

ш

Копировать код
gcc -c -o sin_program.o sin_program.c
Компилируйте программу на ассемблере NASM:

ш

Копировать код
nasm -f elf64 -o sin_program_asm.o sin_program.asm
Соберите объектные файлы:

ш

Копировать код
gcc -o sin_program sin_program.o sin_program_asm.o -lm
Эта программа вычисляет и выводит значения синуса для углов от 0 до 360 градусов с шагом в 1 градус.
